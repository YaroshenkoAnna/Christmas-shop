import{B as c}from"./index-IJChSdQ4.js";import{O as f,S as g,I as x,D as h,o as E,t as N,M as p}from"./option-store-BbK0xcDa.js";import{B as b}from"./button-IiaKAykE.js";const D="_container_ocjbn_7",T="_back_ocjbn_36",y="_sound_ocjbn_40",A="_start_ocjbn_44",O="_disabled_ocjbn_48",o={"wheel-page":"_wheel-page_ocjbn_1",container:D,"wheel-result":"_wheel-result_ocjbn_8",back:T,sound:y,start:A,disabled:O};function k(a,t){let s;return(...e)=>{s!==void 0&&clearTimeout(s),s=setTimeout(()=>{a(...e)},t)}}const w="soundDisabled";class B{soundDisabled=new f(g.load(w)??!0);sounds=[];constructor(){this.soundDisabled.subscribe(t=>{g.save(w,t),this.handleSoundState(t)}),this.handleSoundState(this.soundDisabled.value)}toggleSound(){this.soundDisabled.set(!this.soundDisabled.value)}registerSound(t){this.sounds.push(t),t.muted=this.soundDisabled.value}handleSoundState(t){this.sounds.forEach(s=>{s.muted=t,s.volume=t?0:1})}}const d=new B;function M(a,t){const s=Math.ceil(a),e=Math.floor(t);return Math.floor(Math.random()*(e-s+1))+s}function j(){const a=[];for(let n=0;n<3;n++)a.push(M(0,255));const[t,s,e]=a;return`rgb(${t}, ${s}, ${e})`}const C="_wheel_1q71f_1",I={wheel:C};class F extends c{context;options;constructor(t){super({tag:"canvas",classNames:[I.wheel]}),this.node.width=500,this.node.height=500;const s=this.node.getContext("2d");if(!s)throw new Error("Failed to get 2D context");this.options=t.filter(e=>e.weight>0&&e.title),this.context=s,this.render()}render(){this.drawArcs()}drawArcs(){const t=this.options.length,s=this.options.reduce((n,i)=>n+i.weight,0);let e=0;for(let n=0;n<t;n++){const i=e;console.log("Begin",e);const r=i+2*Math.PI/s*this.options[n].weight;e=r,console.log("End",e),this.context.beginPath(),this.context.moveTo(250,250),this.context.arc(250,250,200,i,r),this.context.lineTo(250,250),this.context.fillStyle=j(),this.context.fill()}}}class W extends c{victorySound=new Audio("victory.mp3");interactiveElements=[];constructor(){super({tag:"main",classNames:[o["wheel-page"]]}),d.registerSound(this.victorySound);const t=new b({text:"Back to Options",callback:()=>{globalThis.location.hash="/"},classNames:[o.back]}),s=new b({text:d.soundDisabled.value?"Sound: Off":"Sound: On",callback:()=>{d.toggleSound()},classNames:[o.sound]});d.soundDisabled.subscribe(l=>{s.setText(l?"Sound: Off":"Sound: On")});const e=new x({type:"number",name:"time",attributes:{min:"0",max:"30"},id:"Time",classNames:[o.time]});e.setValue(h.toString()),e.addListener("input",k(l=>{const _=l.target,m=Number(_.value);m<h?e.setValue(h.toString()):m>p&&e.setValue(p.toString())},1e3));const n=Number(e.getValue()),i=new b({text:"Start",callback:()=>{this.disable(),setTimeout(()=>{this.enable(),this.victorySound.play().catch(l=>{console.error("Failed to play victory sound:",l)})},n*1e3)},classNames:[o.start]}),r=new c({tag:"span",text:"Time",classNames:[o.span]}),u=new c({tag:"div",classNames:[o.container]});u.appendChildren(r,e);const S=new c({tag:"p",classNames:[o["wheel-result"]],text:"Press Start"}),v=new F(E.value);this.appendChildren(N,t,s,u,i,S,v),this.interactiveElements=[e,i,t,s,u]}disable(){this.interactiveElements.forEach(t=>{t.setAttributes({disabled:"true"}),t.addClasses([o.disabled])})}enable(){this.interactiveElements.forEach(t=>{t.removeAttribute("disabled"),t.removeClasses([o.disabled])})}}export{W as WheelPage};
